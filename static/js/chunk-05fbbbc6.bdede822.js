/*!
 *  build: admin-vue-antd 
 *  copyright: AndPHP 417170808@qq.com 
 *  time: 2021-7-1 12:57:32
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05fbbbc6","chunk-2d0efc62"],{8586:function(e,t,r){},"9a15":function(e,t,r){"use strict";r.r(t),r.d(t,"list",(function(){return c})),r.d(t,"update",(function(){return d})),r.d(t,"lock",(function(){return i})),r.d(t,"orderaudit",(function(){return f}));var n=r("1da1"),o=(r("96cf"),r("b775")),a="manage";function c(e){return u.apply(this,arguments)}function u(){return u=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["default"])({url:a+"/flight/order/list",method:"get",params:t}));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function d(e){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["default"])({url:a+"/flight/order/update",method:"put",data:t}));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function i(e){return s.apply(this,arguments)}function s(){return s=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["default"])({url:a+"/flight/order/lock",method:"put",data:t}));case 1:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return b=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(o["default"])({url:a+"/flight/order/audit",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}},b5b1:function(e,t,r){"use strict";r.r(t);var n=r("f2bf"),o=Object(n["withScopeId"])("data-v-088c7916");Object(n["pushScopeId"])("data-v-088c7916");var a=Object(n["createTextVNode"])(" 筛选条件 "),c={key:0},u={key:0},d={key:0},l={key:0},i=Object(n["createTextVNode"])("已完成"),s=Object(n["createTextVNode"])("已作废"),f=Object(n["createTextVNode"])("新增 "),b={key:0},p={style:{"margin-top":"20px"}},m=Object(n["createTextVNode"])("同意"),O=Object(n["createTextVNode"])("拒绝");Object(n["popScopeId"])();var j=o((function(e,t,r,j,h,N){var k=Object(n["resolveComponent"])("p-query"),v=Object(n["resolveComponent"])("a-table"),V=Object(n["resolveComponent"])("a-switch"),y=Object(n["resolveComponent"])("p-table"),g=Object(n["resolveComponent"])("a-form-item"),_=Object(n["resolveComponent"])("a-col"),w=Object(n["resolveComponent"])("a-radio-button"),C=Object(n["resolveComponent"])("a-radio-group"),x=Object(n["resolveComponent"])("a-row"),S=Object(n["resolveComponent"])("PlusOutlined"),I=Object(n["resolveComponent"])("a-button"),M=Object(n["resolveComponent"])("a-input"),R=Object(n["resolveComponent"])("MinusCircleOutlined"),B=Object(n["resolveComponent"])("a-tooltip"),U=Object(n["resolveComponent"])("a-card"),T=Object(n["resolveComponent"])("a-form"),D=Object(n["resolveComponent"])("p-modal");return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])(k,{ref:"query","search-param":e.queryArray,onSearch:j.handleSearch,onReset:j.handleReset},{title:o((function(){return[a]})),_:1},8,["search-param","onSearch","onReset"]),Object(n["createVNode"])(y,{"row-key":"id",columns:e.columns,"form-item-layout":e.formItemLayout,"default-form-model":e.defaultFormModel,"option-tip-field":"key","action-url":e.actionUrl,param:e.param,fetch:j.fetch,operate:e.operate,toolbar:!1,"submit-before":j.onSubmitBefore,checkbox:!1,ref:"tableRef"},{expandedRowRender:o((function(t){var r=t.record,o=t.index;t.indent,t.expanded;return[Object(n["createVNode"])(v,{"row-key":function(){return o},size:"small",columns:e.innerColumns,"data-source":j.cloneArray(r.item),pagination:!1},null,8,["row-key","columns","data-source"])]})),isLock:o((function(e){var t=e.record;return[Object(n["createVNode"])(V,{"checked-children":"是","un-checked-children":"否",checked:t.isLockStr,"onUpdate:checked":function(e){return t.isLockStr=e},onChange:function(e){return j.handleChange(t,e)}},null,8,["checked","onUpdate:checked","onChange"])]})),_:1},8,["columns","form-item-layout","default-form-model","action-url","param","fetch","operate","submit-before"]),Object(n["createVNode"])(D,{visible:e.modalShow,"onUpdate:visible":t[3]||(t[3]=function(t){return e.modalShow=t}),forceRender:!0,title:"订单修改",onOk:j.handleOrderOK,onCancel:j.handleOrderCancel,width:"75%"},{default:o((function(){return[Object(n["createVNode"])(T,{ref:"formRef",model:e.formModel,"label-col":j.labelCol,"wrapper-col":j.wrapperCol,labelAlign:"right"},{default:o((function(){return[Object(n["createVNode"])(x,null,{default:o((function(){return[Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"订单号"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.orderNo),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"订单号"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.orderNo),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"航班号"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.flightName),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"起飞城市"},{default:o((function(){return[e.formModel.stock?(Object(n["openBlock"])(),Object(n["createBlock"])("span",c,Object(n["toDisplayString"])(e.formModel.stock.startCity),1)):Object(n["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"到达城市"},{default:o((function(){return[e.formModel.stock?(Object(n["openBlock"])(),Object(n["createBlock"])("span",u,Object(n["toDisplayString"])(e.formModel.stock.endCity),1)):Object(n["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"起飞时间"},{default:o((function(){return[e.formModel.stock?(Object(n["openBlock"])(),Object(n["createBlock"])("span",d,Object(n["toDisplayString"])(e.formModel.stock.startTime),1)):Object(n["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"到达时间"},{default:o((function(){return[e.formModel.stock?(Object(n["openBlock"])(),Object(n["createBlock"])("span",l,Object(n["toDisplayString"])(e.formModel.stock.endTime),1)):Object(n["createCommentVNode"])("",!0)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:" 姓名（联系人）"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.username),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"证件号"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.idcardNo),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"手机号"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.phone),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"总价格"},{default:o((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.formModel.totalAmount),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"订单状态"},{default:o((function(){return[Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(e.formModel.statusStr),1)]})),_:1})]})),_:1}),Object(n["createVNode"])(_,{span:8,offset:"16"},{default:o((function(){return[Object(n["createVNode"])(g,{label:"修改订单状态为"},{default:o((function(){return[Object(n["createVNode"])(C,{value:e.formModel.status,"onUpdate:value":t[1]||(t[1]=function(t){return e.formModel.status=t}),"button-style":"solid"},{default:o((function(){return[Object(n["createVNode"])(w,{value:4},{default:o((function(){return[i]})),_:1}),Object(n["createVNode"])(w,{value:5},{default:o((function(){return[s]})),_:1})]})),_:1},8,["value"])]})),_:1})]})),_:1})]})),_:1}),Object(n["createVNode"])(x,null,{default:o((function(){return[Object(n["createVNode"])(_,{span:24},{default:o((function(){return[Object(n["createVNode"])(U,{title:"乘机人信息",style:{width:"100%"}},{default:o((function(){return[Object(n["createVNode"])("div",null,[Object(n["createVNode"])(I,{onClick:t[2]||(t[2]=function(t){return j.addItem(e.formModel)}),type:"dashed"},{default:o((function(){return[Object(n["createVNode"])(S),f]})),_:1})]),e.formModel.item?(Object(n["openBlock"])(),Object(n["createBlock"])("div",b,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.formModel.item,(function(e,t){return Object(n["openBlock"])(),Object(n["createBlock"])(x,{key:t,type:"flex"},{default:o((function(){return[Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"姓名（联系人）",name:["item",t,"username"],rules:[{required:!0,message:"不能为空"}]},{default:o((function(){return[Object(n["createVNode"])(M,{value:e.username,"onUpdate:value":function(t){return e.username=t}},null,8,["value","onUpdate:value"])]})),_:2},1032,["name"])]})),_:2},1024),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"证件号",name:["item",t,"idcardNo"],rules:[{required:!0,message:"不能为空"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"证件号格式不对"}]},{default:o((function(){return[Object(n["createVNode"])(M,{value:e.idcardNo,"onUpdate:value":function(t){return e.idcardNo=t}},null,8,["value","onUpdate:value"])]})),_:2},1032,["name","rules"])]})),_:2},1024),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"手机号",name:["item",t,"phone"],rules:[{required:!0,message:"不能为空"},{pattern:/^[1][0-9]{10}$/,message:"手机号格式不对"}]},{default:o((function(){return[Object(n["createVNode"])(M,{value:e.phone,"onUpdate:value":function(t){return e.phone=t}},null,8,["value","onUpdate:value"])]})),_:2},1032,["name"])]})),_:2},1024),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"价格",name:["item",t,"price"],rules:[{required:!0,message:"不能为空"},{pattern:/^\d+(\.\d+)?$/,message:"不能为负数"}]},{default:o((function(){return[Object(n["createVNode"])(M,{type:"number",value:e.price,"onUpdate:value":function(t){return e.price=t},min:0},null,8,["value","onUpdate:value"])]})),_:2},1032,["name","rules"])]})),_:2},1024),Object(n["createVNode"])(_,{span:8},{default:o((function(){return[Object(n["createVNode"])(g,{label:"票号",name:["item",t,"ticketNo"]},{default:o((function(){return[Object(n["createVNode"])(M,{value:e.ticketNo,"onUpdate:value":function(t){return e.ticketNo=t}},null,8,["value","onUpdate:value"])]})),_:2},1032,["name"])]})),_:2},1024),Object(n["createVNode"])(_,{span:1,offset:"1"},{default:o((function(){return[Object(n["createVNode"])(g,null,{default:o((function(){return[Object(n["createVNode"])(B,{title:"删除此条数据"},{default:o((function(){return[Object(n["createVNode"])(I,{onClick:function(r){return j.delItemIds(e,t)},type:"dashed"},{icon:o((function(){return[Object(n["createVNode"])(R)]})),_:2},1032,["onClick"])]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)})),128))])):Object(n["createCommentVNode"])("",!0)]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","label-col","wrapper-col"])]})),_:1},8,["visible","onOk","onCancel"]),Object(n["createVNode"])(D,{visible:e.modalShow2,"onUpdate:visible":t[6]||(t[6]=function(t){return e.modalShow2=t}),forceRender:!0,title:"订单审核",footer:!1},{default:o((function(){return[Object(n["createVNode"])("div",null,"审核订单号为："+Object(n["toDisplayString"])(e.ordernum),1),Object(n["createVNode"])("div",p,[Object(n["createVNode"])(I,{type:"primary",onClick:t[4]||(t[4]=function(e){return j.agreeorder("agree")})},{default:o((function(){return[m]})),_:1}),Object(n["createVNode"])(I,{style:{"margin-left":"20px"},onClick:t[5]||(t[5]=function(e){return j.agreeorder("refuse")})},{default:o((function(){return[O]})),_:1})])]})),_:1},8,["visible"])])})),h=r("1da1"),N=r("5530"),k=(r("96cf"),r("159b"),r("99af"),r("a434"),r("9a15")),v=r("47ce"),V=r("8fc6"),y={name:"sell-order",components:{PlusOutlined:v["a"],MinusCircleOutlined:V["a"]},setup:function(){var e=Object(n["inject"])("message"),t=Object(n["ref"])(null),r=Object(n["ref"])(null),o=Object(n["reactive"])({modalShow2:!1,ordernum:0,param:{},columns:[{title:"订单号",dataIndex:"orderNo",key:"orderNo",sorter:!1},{title:"航班号",dataIndex:"flightName",key:"flightName",sorter:!1},{title:"购买数量",dataIndex:"number",key:"number",sorter:!1},{title:"起飞城市",dataIndex:"stock.startCity",key:"stock.startCity",sorter:!1},{title:"到达城市",dataIndex:"stock.endCity",key:"stock.endCity",sorter:!1},{title:"起飞时间",sorter:!1,dataIndex:"stock.startTime",key:"stock.startTime"},{title:"到达时间",sorter:!1,dataIndex:"stock.endTime",key:"stock.endTime"},{title:"姓名（联系人）",sorter:!1,dataIndex:"username",key:"username"},{title:"证件号",sorter:!1,dataIndex:"idcardNo",key:"idcardNo"},{title:"手机号",sorter:!1,dataIndex:"phone",key:"phone"},{title:"总价格",sorter:!1,dataIndex:"totalAmount",key:"totalAmount"},{title:"订单状态",sorter:!1,dataIndex:"statusStr",key:"statusStr"},{title:"是否锁定",sorter:!1,slots:{customRender:"isLock"}}],innerColumns:[{title:"姓名（联系人）",dataIndex:"username",key:"username",sorter:!1},{title:"证件号",dataIndex:"idcardNo",key:"idcardNo",sorter:!1},{title:"手机号",dataIndex:"phone",key:"phone",sorter:!1},{title:"价格",dataIndex:"price",key:"price",sorter:!1}],defaultFormModel:{id:void 0,orderNo:"",flightStockId:"",flightName:"",number:"",username:"",idcardNo:"",phone:"",totalAmount:"",status:"",isLock:"",statusStr:"",stock:void 0,item:[]},formModel:{id:void 0,orderNo:"",flightStockId:"",flightName:"",number:"",username:"",idcardNo:"",phone:"",totalAmount:"",status:"",isLock:"",statusStr:"",stock:void 0,item:[]},actionUrl:{},formItemLayout:{labelCol:{span:6},wrapperCol:{span:16}},queryArray:[{type:"input",key:"order_no",value:"",label:"订单号",hidden:!1,props:{placeholder:"订单号"}},{type:"input",key:"username",value:"",label:"姓名",hidden:!1,props:{placeholder:"姓名"}},{type:"input",key:"phone",value:"",label:"手机号",hidden:!1,props:{placeholder:"手机号"}}],operate:[{label:"修改",event:function(e){var t=[];e&&e.item.length&&e.item.forEach((function(e){t.push(Object(N["a"])({},e))})),o.formModel=Object(N["a"])(Object(N["a"])({},o.defaultFormModel),e),o.formModel.item=[].concat(t),o.modalShow=!0}},{label:"审核",event:function(e){o.modalShow2=!0,o.ordernum=e.orderNo},hidden:function(e){return 7==e.status}},{label:"删除",event:function(e){}}],modalShow:!1,delItemIds:[]}),a=function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(k["list"])(t);case 2:return r=e.sent,n=r.data,e.abrupt("return",{total:n.total,data:n.data});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(n){var a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={order_no:o.ordernum,type:n},t.next=3,Object(k["orderaudit"])(a);case 3:c=t.sent,0==c.code?(e.success("审核成功"),o.modalShow2=!1,r.value.reload()):e.error(c.msg);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();Object(n["onBeforeMount"])((function(){})),Object(n["onMounted"])(Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),Object(n["onBeforeUpdate"])((function(){})),Object(n["onUpdated"])((function(){})),Object(n["onBeforeUnmount"])((function(){})),Object(n["onUnmounted"])((function(){}));var u=function(e){return e},d=function(e){o.param=e},l=function(e){o.param=e},i={},s=function(){var a=Object(h["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.value.validate().then((function(){var t=Object(n["toRaw"])(o.formModel),a=t,c=a.id,u=a.status,d=a.isLock,l=a.item;t={id:c,status:u,isLock:d,user_info:Object(n["toRaw"])(l),del_item_ids:o.delItemIds},Object(k["update"])(t).then((function(t){0==t.code&&(e.success("修改成功"),r.value.reload())})),o.modalShow=!1}));case 1:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),f=function(){o.formModel=Object(N["a"])({},o.defaultFormModel),o.delItemIds=[],o.modalShow=!1},b=function(t,r){Object(k["lock"])({id:t.id,is_lock:r?1:0}).then((function(t){0==t.code&&e.success("操作成功")}))},p=function(e){var t=[];return e.forEach((function(e){t.push(Object(n["toRaw"])(e))})),t},m=function(e){o.formModel.item.push({idcardNo:"",orderId:e.id,phone:"",price:"",username:"",flightStockId:e.flightStockId})},O=function(e,t){o.formModel.item.splice(t,1),e.id&&o.delItemIds.push(e.id)};return Object(N["a"])(Object(N["a"])({},Object(n["toRefs"])(o)),{},{fetch:a,onSubmitBefore:u,handleSearch:d,handleReset:l,formRef:t,tableRef:r,labelCol:{span:10},wrapperCol:{span:14},rules:i,handleOrderOK:s,handleOrderCancel:f,handleChange:b,cloneArray:p,addItem:m,delItemIds:O,agreeorder:c})}};r("bd08");y.render=j,y.__scopeId="data-v-088c7916";t["default"]=y},bd08:function(e,t,r){"use strict";r("8586")}}]);